setwd("~/Desktop/EquipageSolidaire/packageSolidaire")
setwd("~/Desktop/EquipageSolidaire")
library(tidyverse)
orders <- read_csv("data/order.csv")
View(orders)
setwd("~/Desktop/EquipageSolidaire/EquipageSolidaire_Stats/Report2022")
orders <- read_csv("data/orders_24-04.csv")
View(orders)
orders <- read.csv("data/orders_24-04.csv", sep = ";")
View(orders)
setwd("~/Desktop/EquipageSolidaire/EquipageSolidaire_Stats")
orders <- read.csv("../Resources/latest_orders_data/orders_2205.csv", sep = ";")
library(tidyverse)
orders <- read.csv("../Resources/latest_orders_data/orders_2205.csv", sep = ";")
orders <- read.csv("Resources/latest_orders_data/orders_2205.csv", sep = ";")
View(orders)
unique(orders$city)
#orders completed after app was released
orders_delivered <- orders_app %>%
filter(tracking_status == 3) %>%
#waiting time
mutate(waiting_hours = as.numeric((updatedAt - createdAt)/60),
waiting_days = round(waiting_hours/24))
#orders completed after app was released
orders_delivered <- orders %>%
filter(tracking_status == 3) %>%
#waiting time
mutate(waiting_hours = as.numeric((updatedAt - createdAt)/60),
waiting_days = round(waiting_hours/24))
library(tidyverse)
#orders completed after app was released
orders_delivered <- orders %>%
filter(tracking_status == 3) %>%
#waiting time
mutate(waiting_hours = as.numeric((updatedAt - createdAt)/60),
waiting_days = round(waiting_hours/24))
class(orders$updatedAt)
class(orders$createdAt)
#orders completed after app was released
orders_delivered <- orders %>%
filter(tracking_status == 3) %>%
#waiting time
mutate(waiting_hours = as.numeric((as.Date(updatedAt) - as.Date(createdAt))/60),
waiting_days = round(waiting_hours/24))
View(orders_delivered)
orders
orders <- read_csv("Resources/latest_orders_data/orders_2205.csv")
class(orders$updatedAt)
#orders completed after app was released
orders_delivered <- orders %>%
filter(tracking_status == 3) %>%
#waiting time
mutate(waiting_hours = as.numeric((updatedAt - createdAt)/60),
waiting_days = round(waiting_hours/24))
View(orders_delivered)
unique(orders_delivered$city)
city_orders <- total_orders %>%
mutate(city = case_when(
str_detect(city, "Montpellier") ~ "Montpellier",
str_detect(city, "Toulouse") ~ "Toulouse",
str_detect(str_to_lower(city), paste(strings_Paris, collapse = "|")) ~ "Paris",
str_detect(str_to_lower(city), paste(strings_Grenoble, collapse = "|")) ~ "Grenoble",
str_detect(str_to_lower(city), paste(strings_Strasbourg, collapse = "|")) ~ "Strasbourg",
TRUE ~ city)) %>%
mutate(city = ifelse(city == "Montreuil", "Paris", city))%>%
group_by(city)%>%
summarise(city_deliveries = n())%>%
mutate(perc = scales::percent(city_deliveries / sum(city_deliveries), accuracy = .1, trim = FALSE))
city_orders <- orders_delivered %>%
mutate(city = case_when(
str_detect(city, "Montpellier") ~ "Montpellier",
str_detect(city, "Toulouse") ~ "Toulouse",
str_detect(str_to_lower(city), paste(strings_Paris, collapse = "|")) ~ "Paris",
str_detect(str_to_lower(city), paste(strings_Grenoble, collapse = "|")) ~ "Grenoble",
str_detect(str_to_lower(city), paste(strings_Strasbourg, collapse = "|")) ~ "Strasbourg",
TRUE ~ city)) %>%
mutate(city = ifelse(city == "Montreuil", "Paris", city))%>%
group_by(city)%>%
summarise(city_deliveries = n())%>%
mutate(perc = scales::percent(city_deliveries / sum(city_deliveries), accuracy = .1, trim = FALSE))
#list variations of Nexity to add them to their respective cities
strings_Paris <- c("bagnolet", "tessier")
strings_Grenoble <- c("Weill")
strings_Strasbourg <- c("Winston")
city_orders <- orders_delivered %>%
mutate(city = case_when(
str_detect(city, "Montpellier") ~ "Montpellier",
str_detect(city, "Toulouse") ~ "Toulouse",
str_detect(str_to_lower(city), paste(strings_Paris, collapse = "|")) ~ "Paris",
str_detect(str_to_lower(city), paste(strings_Grenoble, collapse = "|")) ~ "Grenoble",
str_detect(str_to_lower(city), paste(strings_Strasbourg, collapse = "|")) ~ "Strasbourg",
TRUE ~ city)) %>%
mutate(city = ifelse(city == "Montreuil", "Paris", city))%>%
group_by(city)%>%
summarise(city_deliveries = n())%>%
mutate(perc = scales::percent(city_deliveries / sum(city_deliveries), accuracy = .1, trim = FALSE))
View(city_orders)
strings_Grenoble <- c("weill")
strings_Strasbourg <- c("winston")
city_orders <- orders_delivered %>%
mutate(city = case_when(
str_detect(city, "Montpellier") ~ "Montpellier",
str_detect(city, "Toulouse") ~ "Toulouse",
str_detect(str_to_lower(city), paste(strings_Paris, collapse = "|")) ~ "Paris",
str_detect(str_to_lower(city), paste(strings_Grenoble, collapse = "|")) ~ "Grenoble",
str_detect(str_to_lower(city), paste(strings_Strasbourg, collapse = "|")) ~ "Strasbourg",
TRUE ~ city)) %>%
mutate(city = ifelse(city == "Montreuil", "Paris", city))%>%
group_by(city)%>%
summarise(city_deliveries = n())%>%
mutate(perc = scales::percent(city_deliveries / sum(city_deliveries), accuracy = .1, trim = FALSE))
#orders completed after app was released
orders_delivered <- orders %>%
filter(tracking_status == 3) %>%
#waiting time
mutate(waiting_hours = as.numeric((updatedAt - createdAt)/60),
waiting_days = round(waiting_hours/24))
#fix city names
orders_delivered_new <- orders_delivered %>%
mutate(city = case_when(
str_detect(city, "Montpellier") ~ "Montpellier",
str_detect(city, "Toulouse") ~ "Toulouse",
str_detect(str_to_lower(city), paste(strings_Paris, collapse = "|")) ~ "Paris",
str_detect(str_to_lower(city), paste(strings_Grenoble, collapse = "|")) ~ "Grenoble",
str_detect(str_to_lower(city), paste(strings_Strasbourg, collapse = "|")) ~ "Strasbourg",
TRUE ~ city)) %>%
mutate(city = ifelse(city == "Montreuil", "Paris", city))
View(orders_delivered_new)
source("~/Desktop/EquipageSolidaire/EquipageSolidaire_Stats/Useful_Functions/orders_by_city.R")
monthly_orders_city <- orders_delivered_simple %>%
mutate(month_year = format(updatedAt, "%Y-%m")) %>%
complete(city, month_year) %>%
group_by(month_year, city) %>%
summarise(month_deliveries = n())
monthly_orders_city <- orders_delivered_new %>%
mutate(month_year = format(updatedAt, "%Y-%m")) %>%
complete(city, month_year) %>%
group_by(month_year, city) %>%
summarise(month_deliveries = n())
View(monthly_orders_city)
#group by city & month
monthly_orders_city <- orders_delivered_new %>%
mutate(month_year = format(updatedAt, "%Y-%m")) %>%
complete(city, month_year) %>%
group_by(month_year, city) %>%
summarise(month_deliveries = n()) %>%
mutate(month_deliveries = ifelse(month_deliveries == 1, 0, month_deliveries))
View(monthly_orders_city)
monthly_orders_Paris <- monthly_orders_city %>% filter(city == "Paris")
View(monthly_orders_Paris)
monthly_orders_city
#make table long
# Assuming your dataframe is named "df"
new_df <- monthly_orders_city %>%
pivot_wider(names_from = city, values_from = month_deliveries, values_fill = 0)
#make table long
# Assuming your dataframe is named "df"
monthly_orders_city_wide <- monthly_orders_city %>%
pivot_wider(names_from = city, values_from = month_deliveries, values_fill = 0)
View(monthly_orders_city_wide)
library(kableExtra)
library(knitr)
View(monthly_orders_city_wide)
# Assuming your dataframe is named "new_df"
html_table <- monthly_orders_city_wide %>%
kable() %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
# Save the HTML table to a file
writeLines(as.character(html_table), "table.html")
html_table
setwd("~/Desktop/EquipageSolidaire/packageSolidaire")
install.packages(usethis)
install.packages("usethis")
clean
library(usethis)
setwd("~/Desktop/EquipageSolidaire/packageSolidaire/R")
usethis::use_r("group_cities")
usethis::use_r("clean_cities")
usethis::use_r("filter_delivered")
filter_delivered <- function(df) {
df %>% filter(tracking_status == 3)
}
library(tidyverse)
orders <- read_csv("Resources/latest_orders_data/orders_2205.csv")
setwd("~/Desktop/EquipageSolidaire")
orders <- read_csv("Resources/latest_orders_data/orders_2205.csv")
orders <- read_csv("Resources/latest_orders_data/orders_2205.csv")
setwd("~/Desktop/EquipageSolidaire/EquipageSolidaire_Stats")
orders <- read_csv("Resources/latest_orders_data/orders_2205.csv")
setwd("~/Desktop/EquipageSolidaire/packageSolidaire")
filter_delivered(orders)
orders_delivered <- filter_delivered(orders)
View(orders_delivered)
devtools::load_all()
orders_delivered <- filter_delivered(orders)
setwd("~/Desktop/EquipageSolidaire/EquipageSolidaire_Stats")
orders <- read_csv("Resources/latest_orders_data/orders_2205.csv")
orders_delivered <- filter_delivered(orders)
devtools::install()
setwd("~/Desktop/EquipageSolidaire/packageSolidaire")
devtools::install()
devtools::document()
devtools::
devtools::dev
library(roxygen2)
devtools::document()
